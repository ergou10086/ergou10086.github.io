<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Spring Boot part13-全面接管Spring MVC | ErgouTree's Blog</title><meta name="author" content="ErgouTree"><meta name="copyright" content="ErgouTree"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="全面接管 SpringMVC 的思路 SpringBoot 默认配置好了 SpringMVC 的所有常⽤特性。 在 SpringBoot 中，全面接管 SpringMVC 配置的思路是通过禁用默认配置并完全自定义所有 MVC 行为。这是一个高级用法，适用于需要对 SpringMVC 进行深度定制的场景。 全面接管 SpringMVC 的核心步骤如下：  创建一个配置类，实现WebMv">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring Boot part13-全面接管Spring MVC">
<meta property="og:url" content="https://ergou10086.github.io/posts/8200.html">
<meta property="og:site_name" content="ErgouTree&#39;s Blog">
<meta property="og:description" content="全面接管 SpringMVC 的思路 SpringBoot 默认配置好了 SpringMVC 的所有常⽤特性。 在 SpringBoot 中，全面接管 SpringMVC 配置的思路是通过禁用默认配置并完全自定义所有 MVC 行为。这是一个高级用法，适用于需要对 SpringMVC 进行深度定制的场景。 全面接管 SpringMVC 的核心步骤如下：  创建一个配置类，实现WebMv">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ergou10086.github.io/images/posts/cover_java15.jpg">
<meta property="article:published_time" content="2025-06-11T09:01:51.000Z">
<meta property="article:modified_time" content="2025-06-11T09:02:59.080Z">
<meta property="article:author" content="ErgouTree">
<meta property="article:tag" content="Java技术">
<meta property="article:tag" content="JavaWeb">
<meta property="article:tag" content="框架知识">
<meta property="article:tag" content="学习">
<meta property="article:tag" content="JavaEE">
<meta property="article:tag" content="Web">
<meta property="article:tag" content="Spring系列">
<meta property="article:tag" content="Servlet">
<meta property="article:tag" content="Spring Boot">
<meta property="article:tag" content="Java框架">
<meta property="article:tag" content="源码分析">
<meta property="article:tag" content="配置相关">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ergou10086.github.io/images/posts/cover_java15.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Spring Boot part13-全面接管Spring MVC",
  "url": "https://ergou10086.github.io/posts/8200.html",
  "image": "https://ergou10086.github.io/images/posts/cover_java15.jpg",
  "datePublished": "2025-06-11T09:01:51.000Z",
  "dateModified": "2025-06-11T09:02:59.080Z",
  "author": [
    {
      "@type": "Person",
      "name": "ErgouTree",
      "url": "https://github.com/ergou10086"
    }
  ]
}</script><link rel="shortcut icon" href="/img/pi.ico"><link rel="canonical" href="https://ergou10086.github.io/posts/8200.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?https://hm.baidu.com/hm.js?a6ab1b78e2c6320b664f31e8b9bf0e36";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"已切换为繁体中文","cht_to_chs":"已切换为简体中文","day_to_night":"已切换为深色模式","night_to_day":"已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Spring Boot part13-全面接管Spring MVC',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css"><svg aria-hidden="true" style="position:absolute; overflow:hidden; width:0; height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><link rel="stylesheet" href="/css/custom.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg" style="background: linear-gradient(20deg, #0062be, #925696, #cc426e, #fb0347);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/arp.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">121</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">80</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">51</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> Gallery</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-game"></i><span> GalGame</span></a></li><li><a class="site-page child" href="/video/"><i class="fa-fw fas fa-video"></i><span> Video</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:randomPost();"><span> Random</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/images/posts/cover_java15.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">ErgouTree's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Spring Boot part13-全面接管Spring MVC</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> Gallery</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-game"></i><span> GalGame</span></a></li><li><a class="site-page child" href="/video/"><i class="fa-fw fas fa-video"></i><span> Video</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:randomPost();"><span> Random</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div><div id="randomPost"><a class="site-page social-icon search" href="javascript:;" onclick="randomPost()" title="随机访问一篇文章"><i class="fas fa-circle-notch fa-fw"></i></a></div></nav><div id="post-info"><h1 class="post-title">Spring Boot part13-全面接管Spring MVC<a class="post-edit-link" href="https://github.com/ergou10086/ergou10086.github.io/edit/main/source/_posts/_posts/SpringBootpart13-全面接管SpringMVC.md" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-06-11T09:01:51.000Z" title="发表于 2025-06-11 17:01:51">2025-06-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-06-11T09:02:59.080Z" title="更新于 2025-06-11 17:02:59">2025-06-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java%E5%AD%A6%E4%B9%A0/">Java学习</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java%E5%AD%A6%E4%B9%A0/Spring%E7%B3%BB%E5%88%97/">Spring系列</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java%E5%AD%A6%E4%B9%A0/Spring%E7%B3%BB%E5%88%97/Spring-Boot/">Spring Boot</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">9.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>33分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/posts/8200.html#post-comment"><span class="gitalk-comment-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="全面接管-springmvc-的思路">全面接管 SpringMVC 的思路</h2>
<p>SpringBoot 默认配置好了 SpringMVC 的所有常⽤特性。</p>
<p>在 SpringBoot 中，全面接管 SpringMVC
配置的思路是通过禁用默认配置并完全自定义所有 MVC
行为。这是一个高级用法，适用于需要对 SpringMVC 进行深度定制的场景。</p>
<p>全面接管 SpringMVC 的核心步骤如下：</p>
<ol type="1">
<li>创建一个配置类，实现<code>WebMvcConfigurer</code>接口</li>
<li>使用<code>@EnableWebMvc</code>注解禁用 SpringBoot 的默认 MVC
配置</li>
<li>重写<code>WebMvcConfigurer</code>接口中的方法来定义所有需要的 MVC
行为，<code>WebMvcConfigurer</code>组件定义MVC的底层行为</li>
</ol>
<p>回忆一下配置类的三种自定义方式</p>
<table>
<colgroup>
<col style="width: 5%">
<col style="width: 43%">
<col style="width: 16%">
<col style="width: 34%">
</colgroup>
<thead>
<tr>
<th>全自动</th>
<th>直接编写控制器逻辑</th>
<th></th>
<th>全部使用自动配置默认效果</th>
</tr>
</thead>
<tbody>
<tr>
<td>手自一体</td>
<td><code>@Configuration</code> + 配置 <code>WebMvcConfigurer</code> +
配置 <code>WebMvcRegistrations</code></td>
<td>不要标注<code>@EnableWebMvc</code></td>
<td>自动配置效果 手动设置部分功能 定义 MVC 底层组件</td>
</tr>
<tr>
<td>全手动</td>
<td><code>@Configuration</code> + 配置
<code>WebMvcConfigurer</code></td>
<td>标注<code>@EnableWebMvc</code></td>
<td>禁用自动配置效果 全手动设置</td>
</tr>
</tbody>
</table>
<p>例如，如下就是一个全面接管 SpringMVC 配置的示例代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.format.FormatterRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.CacheControl;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.converter.HttpMessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.MessageCodesResolver;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.Validator;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.method.support.HandlerMethodArgumentResolver;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.method.support.HandlerMethodReturnValueHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerExceptionResolver;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span> <span class="comment">// 禁用SpringBoot默认的MVC配置</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebMvcConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置静态资源处理</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;/static/**&quot;</span>)</span><br><span class="line">                .addResourceLocations(<span class="string">&quot;classpath:/static/&quot;</span>)</span><br><span class="line">                .setCacheControl(CacheControl.maxAge(<span class="number">365</span>, TimeUnit.DAYS));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置视图控制器</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> &#123;</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/home&quot;</span>).setViewName(<span class="string">&quot;home&quot;</span>);</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/&quot;</span>).setViewName(<span class="string">&quot;home&quot;</span>);</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/hello&quot;</span>).setViewName(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/login&quot;</span>).setViewName(<span class="string">&quot;login&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置拦截器</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">MyInterceptor</span>()).addPathPatterns(<span class="string">&quot;/**&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置跨域支持</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> &#123;</span><br><span class="line">        registry.addMapping(<span class="string">&quot;/api/**&quot;</span>)</span><br><span class="line">                .allowedOrigins(<span class="string">&quot;http://domain2.com&quot;</span>)</span><br><span class="line">                .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>)</span><br><span class="line">                .allowedHeaders(<span class="string">&quot;header1&quot;</span>, <span class="string">&quot;header2&quot;</span>, <span class="string">&quot;header3&quot;</span>)</span><br><span class="line">                .exposedHeaders(<span class="string">&quot;header1&quot;</span>, <span class="string">&quot;header2&quot;</span>)</span><br><span class="line">                .allowCredentials(<span class="literal">true</span>).maxAge(<span class="number">3600</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置路径匹配</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configurePathMatch</span><span class="params">(PathMatchConfigurer configurer)</span> &#123;</span><br><span class="line">        configurer.setUseSuffixPatternMatch(<span class="literal">false</span>)</span><br><span class="line">                .setUseTrailingSlashMatch(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置内容协商</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configureContentNegotiation</span><span class="params">(ContentNegotiationConfigurer configurer)</span> &#123;</span><br><span class="line">        configurer.defaultContentType(org.springframework.http.MediaType.APPLICATION_JSON);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置消息转换器</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configureMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> &#123;</span><br><span class="line">        <span class="comment">// 自定义消息转换器配置</span></span><br><span class="line">        <span class="comment">// 注意：这里需要完全自定义，SpringBoot不会添加默认的转换器</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置异常处理器</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configureHandlerExceptionResolvers</span><span class="params">(List&lt;HandlerExceptionResolver&gt; resolvers)</span> &#123;</span><br><span class="line">        <span class="comment">// 自定义异常处理器</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置参数解析器</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addArgumentResolvers</span><span class="params">(List&lt;HandlerMethodArgumentResolver&gt; resolvers)</span> &#123;</span><br><span class="line">        <span class="comment">// 添加自定义参数解析器</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置返回值处理器</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addReturnValueHandlers</span><span class="params">(List&lt;HandlerMethodReturnValueHandler&gt; handlers)</span> &#123;</span><br><span class="line">        <span class="comment">// 添加自定义返回值处理器</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置数据格式化</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addFormatters</span><span class="params">(FormatterRegistry registry)</span> &#123;</span><br><span class="line">        <span class="comment">// 添加自定义格式化器</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置Validator</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Validator <span class="title function_">getValidator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 返回自定义Validator</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置消息代码解析器</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> MessageCodesResolver <span class="title function_">getMessageCodesResolver</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 返回自定义消息代码解析器</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 配置RequestMappingHandlerMapping</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RequestMappingHandlerMapping <span class="title function_">requestMappingHandlerMapping</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">RequestMappingHandlerMapping</span> <span class="variable">mapping</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RequestMappingHandlerMapping</span>();</span><br><span class="line">        mapping.setOrder(<span class="number">0</span>);</span><br><span class="line">        mapping.setInterceptors(getInterceptors());</span><br><span class="line">        <span class="comment">// 自定义配置</span></span><br><span class="line">        <span class="keyword">return</span> mapping;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol type="1">
<li><strong><span class="citation" data-cites="EnableWebMvc">@EnableWebMvc</span>
注解</strong>：这个注解是全面接管的关键，它会禁用 SpringBoot 的自动 MVC
配置，让你完全控制所有 MVC 行为。</li>
<li><strong>WebMvcConfigurer
接口</strong>：实现这个接口并重写其方法，可以自定义各种 MVC 行为：
<ul>
<li>静态资源处理</li>
<li>视图控制器配置</li>
<li>拦截器注册</li>
<li>跨域支持</li>
<li>路径匹配策略</li>
<li>内容协商</li>
<li>消息转换器</li>
<li>异常处理器</li>
<li>参数解析器</li>
<li>返回值处理器</li>
<li>数据格式化</li>
</ul></li>
<li><strong>自定义 Bean</strong>：除了实现接口方法外，还可以通过
<code>@Bean</code>注解提供自定义的组件，如
<code>RequestMappingHandlerMapping</code>、<code>Validator</code>等。</li>
</ol>
<h2 id="webmvcconfigurer-接口分析及方法详解">WebMvcConfigurer
接口分析及方法详解</h2>
<h3 id="源码分析">源码分析</h3>
<p><code>org.springframework.web.servlet.config.annotation.WebMvcConfigurer</code>
是 Spring MVC 提供的一个接口，用于自定义 Web MVC 的配置。它是一个
<strong>标记接口（marker
interface）</strong>，它本身没有任何抽象方法，但提供了一组默认为空实现的方法（Java
8+ 的 default 方法），开发者可以选择性地覆盖这些方法来定制 Spring MVC
的行为。</p>
<p>来看看<code>WebMvcConfigurer</code>接口的源代码，对应方法我编写了注释</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.springframework.web.servlet.config.annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> org.springframework.format.FormatterRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.converter.HttpMessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.lang.Nullable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.MessageCodesResolver;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.Validator;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.ErrorResponse;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.method.support.HandlerMethodArgumentResolver;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.method.support.HandlerMethodReturnValueHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerExceptionResolver;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用于自定义Spring MVC配置的接口。</span></span><br><span class="line"><span class="comment"> * 实现此接口的类可以选择性地重写其方法来自定义Spring MVC的行为，</span></span><br><span class="line"><span class="comment"> * 而无需使用XML配置或完全替换默认配置。</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * 注意：如果使用<span class="doctag">@EnableWebMvc</span>注解，Spring Boot的自动配置将被禁用，</span></span><br><span class="line"><span class="comment"> * 所有MVC配置都必须通过实现此接口来显式定义。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置路径匹配选项，如后缀模式匹配、尾部斜杠匹配等。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">configurePathMatch</span><span class="params">(PathMatchConfigurer configurer)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置内容协商策略，用于确定请求和响应的媒体类型。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">configureContentNegotiation</span><span class="params">(ContentNegotiationConfigurer configurer)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置异步请求处理选项，如异步请求超时时间、任务执行器等。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">configureAsyncSupport</span><span class="params">(AsyncSupportConfigurer configurer)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置默认Servlet处理，用于处理静态资源请求。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">configureDefaultServletHandling</span><span class="params">(DefaultServletHandlerConfigurer configurer)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册自定义的格式化器和转换器，用于类型转换和格式化。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">addFormatters</span><span class="params">(FormatterRegistry registry)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册自定义的拦截器，用于处理请求的预处理和后处理。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册自定义的资源处理器，用于处理静态资源请求。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置跨域资源共享(CORS)映射，允许跨域请求。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册视图控制器，用于直接映射URL到视图而不需要控制器方法。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置视图解析器，用于将逻辑视图名称解析为实际的视图实现。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">configureViewResolvers</span><span class="params">(ViewResolverRegistry registry)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册自定义的处理器方法参数解析器，用于处理控制器方法的参数。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">addArgumentResolvers</span><span class="params">(List&lt;HandlerMethodArgumentResolver&gt; resolvers)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册自定义的处理器方法返回值处理器，用于处理控制器方法的返回值。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">addReturnValueHandlers</span><span class="params">(List&lt;HandlerMethodReturnValueHandler&gt; handlers)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置HTTP消息转换器列表。此方法用于完全自定义消息转换器，</span></span><br><span class="line"><span class="comment">     * 会替换默认的转换器列表。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">configureMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 扩展默认的HTTP消息转换器列表。此方法用于在默认转换器的基础上添加自定义转换器，</span></span><br><span class="line"><span class="comment">     * 而不是替换它们。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">extendMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置处理器异常解析器列表。此方法用于完全自定义异常解析器，</span></span><br><span class="line"><span class="comment">     * 会替换默认的解析器列表。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">configureHandlerExceptionResolvers</span><span class="params">(List&lt;HandlerExceptionResolver&gt; resolvers)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 扩展默认的处理器异常解析器列表。此方法用于在默认解析器的基础上添加自定义解析器，</span></span><br><span class="line"><span class="comment">     * 而不是替换它们。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">extendHandlerExceptionResolvers</span><span class="params">(List&lt;HandlerExceptionResolver&gt; resolvers)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加错误响应拦截器，用于自定义错误响应的处理。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">addErrorResponseInterceptors</span><span class="params">(List&lt;ErrorResponse.Interceptor&gt; interceptors)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 提供自定义的Validator实现，用于数据验证。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="keyword">default</span> Validator <span class="title function_">getValidator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 提供自定义的MessageCodesResolver实现，用于解析验证错误代码。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="keyword">default</span> MessageCodesResolver <span class="title function_">getMessageCodesResolver</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>总结下来就是：</p>
<table>
<colgroup>
<col style="width: 24%">
<col style="width: 40%">
<col style="width: 36%">
</colgroup>
<thead>
<tr>
<th>方法名</th>
<th>描述</th>
<th>常用场景</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>configurePathMatch</code></td>
<td>配置路径匹配选项，如后缀模式匹配、尾部斜杠匹配等</td>
<td>自定义 URL 匹配规则，如禁用<code>.html</code>后缀匹配</td>
</tr>
<tr>
<td><code>configureContentNegotiation</code></td>
<td>配置内容协商策略，用于确定请求和响应的媒体类型</td>
<td>设置默认响应格式为 JSON，配置基于 URL 扩展名的内容协商</td>
</tr>
<tr>
<td><code>configureAsyncSupport</code></td>
<td>配置异步请求处理选项，如异步请求超时时间、任务执行器等</td>
<td>设置异步请求超时时间，配置 DeferredResult 处理</td>
</tr>
<tr>
<td><code>configureDefaultServletHandling</code></td>
<td>配置默认 Servlet 处理，用于处理静态资源请求</td>
<td>启用默认 Servlet 处理静态资源</td>
</tr>
<tr>
<td><code>addFormatters</code></td>
<td>注册自定义的格式化器和转换器，用于类型转换和格式化</td>
<td>添加日期格式化器，注册自定义类型转换器</td>
</tr>
<tr>
<td><code>addInterceptors</code></td>
<td>注册自定义的拦截器，用于处理请求的预处理和后处理</td>
<td>添加身份验证拦截器，实现请求日志记录</td>
</tr>
<tr>
<td><code>addResourceHandlers</code></td>
<td>注册自定义的资源处理器，用于处理静态资源请求</td>
<td>配置静态资源路径，设置缓存控制头</td>
</tr>
<tr>
<td><code>addCorsMappings</code></td>
<td>配置跨域资源共享 (CORS) 映射，允许跨域请求</td>
<td>允许特定域名访问 API，配置跨域请求头</td>
</tr>
<tr>
<td><code>addViewControllers</code></td>
<td>注册视图控制器，用于直接映射 URL 到视图而不需要控制器方法</td>
<td>简化登录页面、主页等简单视图的映射</td>
</tr>
<tr>
<td><code>configureViewResolvers</code></td>
<td>配置视图解析器，用于将逻辑视图名称解析为实际的视图实现</td>
<td>配置 JSP、Thymeleaf 等视图解析器</td>
</tr>
<tr>
<td><code>addArgumentResolvers</code></td>
<td>注册自定义的处理器方法参数解析器，用于处理控制器方法的参数</td>
<td>添加自定义参数解析器，如用户会话参数</td>
</tr>
<tr>
<td><code>addReturnValueHandlers</code></td>
<td>注册自定义的处理器方法返回值处理器，用于处理控制器方法的返回值</td>
<td>添加自定义返回值处理器，如统一 API 响应格式</td>
</tr>
<tr>
<td><code>configureMessageConverters</code></td>
<td>配置 HTTP 消息转换器列表，会替换默认转换器</td>
<td>完全自定义消息转换器，如使用自定义 JSON 序列化器</td>
</tr>
<tr>
<td><code>extendMessageConverters</code></td>
<td>扩展默认的 HTTP 消息转换器列表</td>
<td>在默认转换器基础上添加自定义转换器</td>
</tr>
<tr>
<td><code>configureHandlerExceptionResolvers</code></td>
<td>配置处理器异常解析器列表，会替换默认解析器</td>
<td>完全自定义异常处理机制</td>
</tr>
<tr>
<td><code>extendHandlerExceptionResolvers</code></td>
<td>扩展默认的处理器异常解析器列表</td>
<td>添加自定义异常处理器</td>
</tr>
<tr>
<td><code>addErrorResponseInterceptors</code></td>
<td>添加错误响应拦截器，用于自定义错误响应的处理</td>
<td>自定义错误响应格式，添加额外错误信息</td>
</tr>
<tr>
<td><code>getValidator</code></td>
<td>提供自定义的 Validator 实现，用于数据验证</td>
<td>提供自定义验证器，如使用 Hibernate Validator</td>
</tr>
<tr>
<td><code>getMessageCodesResolver</code></td>
<td>提供自定义的 MessageCodesResolver 实现，用于解析验证错误代码</td>
<td>自定义错误代码解析逻辑</td>
</tr>
</tbody>
</table>
<p>接下来我会挑出其中重要的进行分析和讲解</p>
<h3 id="configuremessageconverters-vs-extendmessageconverters"><code>configureMessageConverters</code>
vs <code>extendMessageConverters</code></h3>
<p>Spring MVC 默认提供了一系列消息转换器，如
<code>MappingJackson2HttpMessageConverter</code>（JSON）、<code>StringHttpMessageConverter</code>
等</p>
<p>这两个方法都用于配置 HTTP 消息转换器，但作用不同</p>
<ul>
<li><code>configureMessageConverters</code>:
完全自定义消息转换器列表，会替换默认的转换器</li>
<li><code>extendMessageConverters</code>:
在默认转换器的基础上添加自定义转换器</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configureMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> &#123;</span><br><span class="line">    <span class="comment">// 完全自定义消息转换器，不使用默认转换器</span></span><br><span class="line">    converters.add(<span class="keyword">new</span> <span class="title class_">MappingJackson2HttpMessageConverter</span>());</span><br><span class="line">    converters.add(<span class="keyword">new</span> <span class="title class_">StringHttpMessageConverter</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">extendMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> &#123;</span><br><span class="line">    <span class="comment">// 在默认转换器的基础上添加自定义转换器</span></span><br><span class="line">    converters.add(<span class="keyword">new</span> <span class="title class_">MyCustomHttpMessageConverter</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>建议使用 <code>extendMessageConverters</code> 和
<code>extendHandlerExceptionResolvers</code> 而不是完全替换默认配置</p>
<p>底层实现差异：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在RequestMappingHandlerAdapter初始化时调用</span></span><br><span class="line"><span class="keyword">if</span> (configurers.configureMessageConverters) &#123;</span><br><span class="line">    <span class="comment">// 完全替换默认转换器</span></span><br><span class="line">    adapter.setMessageConverters(converters); </span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 追加自定义转换器</span></span><br><span class="line">    adapter.addMessageConverters(converters);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="addinterceptorsinterceptorregistry-registry"><code>addInterceptors(InterceptorRegistry registry)</code></h3>
<p>用于注册自定义拦截器，可以在请求处理前后执行特定逻辑，如身份验证、日志记录等。</p>
<p>拦截器很像 Servlet
中的过滤器（Filter），但拦截器提供了更精细的控制和更丰富的功能，允许你在请求处理的不同阶段执行特定逻辑</p>
<p>拦截器是实现横切关注点的好方法，如认证、日志、性能监控等，在这里写一些登录常用的逻辑很不错</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">    registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">AuthenticationInterceptor</span>())</span><br><span class="line">            .addPathPatterns(<span class="string">&quot;/api/**&quot;</span>)  <span class="comment">// 拦截路径</span></span><br><span class="line">            .excludePathPatterns(<span class="string">&quot;/api/public/**&quot;</span>);  <span class="comment">// 排除路径</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>拦截器链的执行原理</p>
<pre><code class="highlight mermaid">sequenceDiagram
    participant DispatcherServlet
    participant Interceptor1
    participant Interceptor2
    participant Handler
    
    DispatcherServlet-&gt;&gt;Interceptor1: preHandle()
    Interceptor1-&gt;&gt;Interceptor2: preHandle()
    Interceptor2-&gt;&gt;Handler: 执行控制器方法
    Handler--&gt;&gt;Interceptor2: postHandle()
    Interceptor2--&gt;&gt;Interceptor1: postHandle()
    Interceptor1--&gt;&gt;DispatcherServlet: afterCompletion()</code></pre>
<p><strong>拦截器与过滤器对比</strong>：</p>
<table>
<thead>
<tr>
<th>特性</th>
<th>拦截器(Interceptor)</th>
<th>过滤器(Filter)</th>
</tr>
</thead>
<tbody>
<tr>
<td>作用域</td>
<td>Spring MVC上下文</td>
<td>Servlet容器层面</td>
</tr>
<tr>
<td>依赖</td>
<td>依赖Spring框架</td>
<td>仅需Servlet API</td>
</tr>
<tr>
<td>执行时机</td>
<td>控制器方法前后</td>
<td>请求进入Servlet之前</td>
</tr>
<tr>
<td>异常处理</td>
<td>可接入ControllerAdvice</td>
<td>只能跳转错误页面</td>
</tr>
</tbody>
</table>
<h3 id="addresourcehandlers"><code>addResourceHandlers</code></h3>
<p>用于配置静态资源处理器，如
CSS、JavaScript、图片等文件的访问路径。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">    <span class="comment">// 自定义静态资源路径</span></span><br><span class="line">    registry.addResourceHandler(<span class="string">&quot;/static/**&quot;</span>)</span><br><span class="line">            .addResourceLocations(<span class="string">&quot;classpath:/static/&quot;</span>)</span><br><span class="line">            .setCacheControl(CacheControl.maxAge(<span class="number">365</span>, TimeUnit.DAYS));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 配置WebJars支持</span></span><br><span class="line">    registry.addResourceHandler(<span class="string">&quot;/webjars/**&quot;</span>)</span><br><span class="line">            .addResourceLocations(<span class="string">&quot;classpath:/META-INF/resources/webjars/&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 配置自定义欢迎页</span></span><br><span class="line">    registry.addResourceHandler(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">            .addResourceLocations(<span class="string">&quot;classpath:/public/index.html&quot;</span>)</span><br><span class="line">            .setCacheControl(CacheControl.noCache());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="addcorsmappings"><code>addCorsMappings</code></h3>
<p>用于配置跨域资源共享 (CORS)，允许浏览器从不同域名访问 API。</p>
<p><strong>CORS 原理</strong>：</p>
<ul>
<li>浏览器实施同源策略，跨域请求需服务器明确允许</li>
<li>简单请求直接发送，预检请求（复杂请求）先发送 OPTIONS 请求</li>
<li>Spring MVC
通过设置响应头（如<code>Access-Control-Allow-Origin</code>）实现 CORS
支持</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> &#123;</span><br><span class="line">    registry.addMapping(<span class="string">&quot;/api/**&quot;</span>)</span><br><span class="line">            .allowedOrigins(<span class="string">&quot;http://example.com&quot;</span>, <span class="string">&quot;https://example.com&quot;</span>)</span><br><span class="line">            .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;PUT&quot;</span>, <span class="string">&quot;DELETE&quot;</span>, <span class="string">&quot;OPTIONS&quot;</span>)</span><br><span class="line">            .allowedHeaders(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;Authorization&quot;</span>, <span class="string">&quot;X-Requested-With&quot;</span>)</span><br><span class="line">            .exposedHeaders(<span class="string">&quot;Location&quot;</span>, <span class="string">&quot;X-Total-Count&quot;</span>)</span><br><span class="line">            .allowCredentials(<span class="literal">true</span>)</span><br><span class="line">            .maxAge(<span class="number">3600</span>); <span class="comment">// 预检请求缓存1小时</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 针对特定API的细粒度配置</span></span><br><span class="line">    registry.addMapping(<span class="string">&quot;/api/auth/**&quot;</span>)</span><br><span class="line">            .allowedOrigins(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">            .allowedMethods(<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;OPTIONS&quot;</span>)</span><br><span class="line">            .maxAge(<span class="number">3600</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="configurehandlerexceptionresolvers-vs-extendhandlerexceptionresolvers"><code>configureHandlerExceptionResolvers</code>
vs <code>extendHandlerExceptionResolvers</code></h3>
<p><strong>默认异常解析器</strong>：</p>
<ol type="1">
<li><code>ExceptionHandlerExceptionResolver</code> -
处理带<code>@ExceptionHandler</code>注解的方法</li>
<li><code>ResponseStatusExceptionResolver</code> -
处理带<code>@ResponseStatus</code>注解的异常</li>
<li><code>DefaultHandlerExceptionResolver</code> - 处理 Spring MVC
标准异常</li>
</ol>
<p>这两个方法用于配置异常处理器：</p>
<ul>
<li><code>configureHandlerExceptionResolvers</code>:
完全自定义异常处理器列表</li>
<li><code>extendHandlerExceptionResolvers</code>:
在默认处理器的基础上添加自定义处理器</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">extendHandlerExceptionResolvers</span><span class="params">(List&lt;HandlerExceptionResolver&gt; resolvers)</span> &#123;</span><br><span class="line">    <span class="comment">// 添加自定义异常解析器</span></span><br><span class="line">    resolvers.add(<span class="keyword">new</span> <span class="title class_">MyCustomExceptionResolver</span>());</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 找到并修改默认的ExceptionHandlerExceptionResolver</span></span><br><span class="line">    resolvers.stream()</span><br><span class="line">            .filter(resolver -&gt; resolver <span class="keyword">instanceof</span> ExceptionHandlerExceptionResolver)</span><br><span class="line">            .findFirst()</span><br><span class="line">            .ifPresent(resolver -&gt; &#123;</span><br><span class="line">                <span class="type">ExceptionHandlerExceptionResolver</span> <span class="variable">exResolver</span> <span class="operator">=</span> (ExceptionHandlerExceptionResolver) resolver;</span><br><span class="line">                <span class="comment">// 自定义配置</span></span><br><span class="line">            &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="configurecontentnegotiationcontentnegotiationconfigurer-configurer"><code>configureContentNegotiation(ContentNegotiationConfigurer configurer)</code></h3>
<p>配置内容协商策略，根据请求头或 URL 参数决定返回的数据格式（如
JSON、XML）。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configureContentNegotiation</span><span class="params">(ContentNegotiationConfigurer configurer)</span> &#123;</span><br><span class="line">    configurer</span><br><span class="line">        .favorParameter(<span class="literal">true</span>) <span class="comment">// 优先使用请求参数</span></span><br><span class="line">        .parameterName(<span class="string">&quot;format&quot;</span>) <span class="comment">// 参数名</span></span><br><span class="line">        .ignoreAcceptHeader(<span class="literal">false</span>) <span class="comment">// 不忽略Accept头</span></span><br><span class="line">        .useRegisteredExtensionsOnly(<span class="literal">false</span>) <span class="comment">// 允许未注册的扩展名</span></span><br><span class="line">        .defaultContentType(MediaType.APPLICATION_JSON) <span class="comment">// 默认内容类型</span></span><br><span class="line">        .mediaType(<span class="string">&quot;json&quot;</span>, MediaType.APPLICATION_JSON) <span class="comment">// 注册媒体类型映射</span></span><br><span class="line">        .mediaType(<span class="string">&quot;xml&quot;</span>, MediaType.APPLICATION_XML);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="configureasyncsupportasyncsupportconfigurer-configurer"><code>configureAsyncSupport(AsyncSupportConfigurer configurer)</code></h3>
<p><strong>异步请求类型</strong>：</p>
<ol type="1">
<li><code>Callable</code> -
控制器返回<code>Callable</code>，在单独线程中执行</li>
<li><code>DeferredResult</code> -
控制器返回<code>DeferredResult</code>，在另一个线程中设置结果</li>
<li><code>ResponseBodyEmitter</code> - 流式响应</li>
<li><code>SseEmitter</code> - 服务器发送事件</li>
<li><code>StreamingResponseBody</code> - 流式响应体</li>
</ol>
<p>配置异步请求支持，例如设置任务执行超时时间、线程池等。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configureAsyncSupport</span><span class="params">(AsyncSupportConfigurer configurer)</span> &#123;</span><br><span class="line">    <span class="comment">// 设置超时时间</span></span><br><span class="line">    configurer.setDefaultTimeout(<span class="number">30000</span>); <span class="comment">// 30秒</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 配置异步任务执行器</span></span><br><span class="line">    <span class="type">ThreadPoolTaskExecutor</span> <span class="variable">executor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolTaskExecutor</span>();</span><br><span class="line">    executor.setCorePoolSize(<span class="number">10</span>);</span><br><span class="line">    executor.setMaxPoolSize(<span class="number">100</span>);</span><br><span class="line">    executor.setQueueCapacity(<span class="number">100</span>);</span><br><span class="line">    executor.setThreadNamePrefix(<span class="string">&quot;AsyncTask-&quot;</span>);</span><br><span class="line">    executor.initialize();</span><br><span class="line">    configurer.setTaskExecutor(executor);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 注册异步请求拦截器</span></span><br><span class="line">    configurer.registerCallableInterceptors(<span class="keyword">new</span> <span class="title class_">TimeoutCallableProcessingInterceptor</span>());</span><br><span class="line">    configurer.registerDeferredResultInterceptors(<span class="keyword">new</span> <span class="title class_">TimeoutDeferredResultProcessingInterceptor</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="configurepathmatchpathmatchconfigurer-configurer"><code>configurePathMatch(PathMatchConfigurer configurer)</code></h3>
<p><strong>关键配置项</strong>：</p>
<ul>
<li><code>setUseSuffixPatternMatch</code> -
是否启用后缀模式匹配（如<code>/users.html</code>匹配<code>/users</code>）</li>
<li><code>setUseTrailingSlashMatch</code> -
是否启用尾部斜杠匹配（如<code>/users/</code>匹配<code>/users</code>）</li>
<li><code>setUseRegisteredSuffixPatternMatch</code> -
仅匹配已注册的后缀</li>
<li><code>setPathMatcher</code> - 设置自定义路径匹配器</li>
<li><code>setUrlPathHelper</code> - 设置自定义 URL 路径帮助器</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configurePathMatch</span><span class="params">(PathMatchConfigurer configurer)</span> &#123;</span><br><span class="line">    <span class="comment">// 禁用后缀模式匹配（防止/resource.json绕过安全检查）</span></span><br><span class="line">    configurer.setUseSuffixPatternMatch(<span class="literal">false</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 启用尾部斜杠匹配</span></span><br><span class="line">    configurer.setUseTrailingSlashMatch(<span class="literal">true</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 配置路径匹配器</span></span><br><span class="line">    <span class="type">AntPathMatcher</span> <span class="variable">pathMatcher</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AntPathMatcher</span>();</span><br><span class="line">    pathMatcher.setCaseSensitive(<span class="literal">true</span>); <span class="comment">// 区分大小写</span></span><br><span class="line">    pathMatcher.setTrimTokens(<span class="literal">true</span>); <span class="comment">// 去除路径中的空白字符</span></span><br><span class="line">    configurer.setPathMatcher(pathMatcher);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="webmvcautoconfiguration-到底自动配置了哪些规则">WebMvcAutoConfiguration
到底自动配置了哪些规则</h2>
<p>SpringMVC
自动配置场景给我们配置了如下所有默认行为，其中的过程和涉及到的细节内容我也一起讲解，因为东西太多，只是过一遍会很混乱</p>
<ol type="1">
<li><p><code>WebMvcAutoConfiguration</code> web 场景的自动配置类</p>
<ul>
<li><p>支持 RESTful 的 filter：<code>HiddenHttpMethodFilter</code></p>
<ul>
<li>作用：在浏览器表单仅支持 <code>GET</code>、<code>POST</code>
原生请求方法的限制下，通过请求参数（默认参数名为 <code>_method</code>
），将 <code>POST</code> 请求转换为
<code>PUT</code>、<code>DELETE</code>、<code>PATCH</code> 等符合 RESTful
规范的请求方法，让普通表单也能适配 RESTful 风格接口。</li>
<li>例如：前端页面要发送一个删除资源的 <code>DELETE</code>
请求，但浏览器无法直接发起，就可以用 <code>POST</code> 表单携带
<code>_method=DELETE</code> 参数，经此 Filter 转换后，后端控制器就能用
<code>@DeleteMapping</code> 接收处理。</li>
</ul></li>
<li><p>支持非 POST
请求，请求体携带数据：<code>FormContentFilter</code></p>
<ul>
<li>作用：对于 <code>PUT</code>、<code>PATCH</code> 等非
<code>POST</code> 请求，解决浏览器默认不会像 <code>POST</code>
请求那样自动携带表单数据（请求体内容
）的问题。它会解析请求体中的表单参数，并将这些参数填充到请求对象中，使后端控制器方法能像处理
<code>POST</code> 请求参数一样，正常获取
<code>PUT</code>、<code>PATCH</code> 等请求携带的表单数据。比如前端用
<code>PUT</code>
请求更新用户信息，携带表单形式的用户姓名、年龄等参数，后端通过
<code>@RequestParam</code> 等注解就能顺利拿到这些参数进行业务处理。</li>
<li>生效逻辑：自动注册到 Filter 链，针对
<code>PUT</code>、<code>PATCH</code>
等方法的请求，在请求处理前期解析请求体表单数据，为后续控制器方法执行做准备。</li>
</ul></li>
<li><p>导入 <code>EnableWebMvcConfiguration</code>：</p>
<p><code>EnableWebMvcConfiguration</code> 是
<code>WebMvcAutoConfiguration</code> 内部类，继承自
<code>DelegatingWebMvcConfiguration</code> ，它借助 Spring
框架的配置机制，进一步初始化和配置一系列 Spring MVC
核心组件，具体如下：</p>
<ul>
<li><p><code>RequestMappingHandlerAdapter</code>:</p>
<ul>
<li>作为 Spring MVC 中处理请求的重要适配器，负责调用被
<code>@RequestMapping</code>（及衍生的
<code>@GetMapping</code>、<code>@PostMapping</code> 等
）标注的控制器方法。在调用过程中，它会处理请求参数的绑定（比如将 HTTP
请求参数转换为控制器方法的入参类型
）、返回值的处理（把控制器方法返回结果转换为合适的响应数据格式，如
JSON、视图名等 ），是连接请求、控制器方法、响应的关键桥梁。</li>
<li>初始化：由 <code>EnableWebMvcConfiguration</code> 依据 Spring 容器的
Bean 管理机制，结合默认配置和用户可能的自定义配置（若有实现
<code>WebMvcConfigurer</code> 相关参数处理定制
），完成创建和初始化，确保能适配各种常见的参数、返回值处理场景。</li>
</ul></li>
<li><p><code>WelcomePageHandlerMapping</code>：欢迎页功能支持（模板引擎目录、静态资源目录放
index.html）</p>
<ul>
<li>当访问应用根路径（<code>/</code>
）时，它会按照一定优先级顺序去查找欢迎页资源。优先在模板引擎可解析的目录（如使用
Thymeleaf 时的 <code>classpath:/templates/</code> ）下查找
<code>index.html</code>
，若未找到，会到静态资源目录（<code>classpath:/META-INF/resources/</code>、<code>classpath:/resources/</code>、<code>classpath:/static/</code>、<code>classpath:/public/</code>
等 ）中寻找 <code>index.html</code>
文件，找到后就会将该页面作为欢迎页展示，让访问根路径的请求能直接呈现友好的首页内容。</li>
</ul></li>
<li><p><code>RequestMappingHandlerMapping</code>：找每个请求由谁处理的映射关系</p>
<ul>
<li>负责扫描 Spring 容器中所有被
<code>@Controller</code>、<code>@RestController</code>
标注的控制器类，以及这些类中被 <code>@RequestMapping</code>
及其衍生注解（<code>@GetMapping</code>、<code>@PostMapping</code> 等
）标注的方法，然后建立并维护 “请求路径 ↔︎ 控制器方法”
的映射关系。后续当有 HTTP
请求到达时，能依据请求路径快速找到对应的控制器方法进行处理，是 Spring
MVC 实现请求路由的核心基础。</li>
<li>扫描与构建：在应用启动时，它会遍历符合条件的 Bean
，解析注解信息，构建起庞大的请求路径映射注册表，并且在应用运行过程中，若有
Bean 动态加载（如通过 Bean 定义注册器新增控制器 Bean
），也能适时更新映射关系。</li>
</ul></li>
<li><p><code>ExceptionHandlerExceptionResolver</code>：默认的异常解析器</p>
<ul>
<li>作为 Spring MVC
默认的异常解析器，用于处理控制器方法执行过程中抛出的异常。它会查找被
<code>@ExceptionHandler</code>
标注的异常处理方法（可以是当前控制器类中的方法，也能是通过
<code>@ControllerAdvice</code> 全局配置的方法
），将异常交由对应的处理方法进行逻辑处理（比如返回自定义错误提示、错误码等
），最终生成合适的响应（可以是 JSON 数据、错误页面等
）返回给客户端，保证应用遇到异常时能有统一、友好的错误处理表现。</li>
<li>异常处理流程：当控制器方法抛出异常后，<code>DispatcherServlet</code>
会将异常交给 <code>ExceptionHandlerExceptionResolver</code>
，它依据异常类型去匹配对应的 <code>@ExceptionHandler</code>
方法，执行方法得到处理结果后，再转换为响应发送给客户端，若未找到匹配的处理方法，会按默认的异常处理逻辑（如返回
500 错误等 ）处理。</li>
</ul></li>
<li><p><code>LocaleResolver</code>：国际化解析器</p>
<ul>
<li>用于处理 Web 应用的国际化（多语言
）需求，解析请求中的语言区域信息。默认情况下，它会根据 HTTP 请求头中的
<code>Accept-Language</code> 字段来判断客户端期望的语言类型（如
<code>zh-CN</code> 表示中文 - 中国，<code>en-US</code> 表示英文 - 美国
），然后结合应用中配置的国际化资源文件（如
<code>messages_zh_CN.properties</code>、<code>messages_en_US.properties</code>
等
），为后续的视图渲染、消息提示等提供对应的语言环境支持，让应用能根据不同地区用户展示合适的语言内容。</li>
<li>若默认的基于 <code>Accept-Language</code>
的解析方式不能满足需求（比如想通过请求参数 <code>?lang=zh</code>
来切换语言 ），可通过实现 <code>LocaleResolver</code>
接口自定义解析逻辑，再配置到 Spring MVC 环境中替换默认实现。</li>
</ul></li>
<li><p><code>ThemeResolver</code>：主题解析器</p>
<ul>
<li>主要用于处理 Web
应用的主题切换需求，比如不同的页面风格、样式主题等。它会依据一定的规则（默认可通过请求参数、Session
等方式
）确定当前请求对应的主题，后续视图解析、资源加载等环节就能根据主题信息，使用对应的主题资源（如不同主题的
CSS 样式文件、页面模板等 ），实现应用界面主题的灵活切换和展示。</li>
<li>应用场景：在一些需要让用户自定义界面风格（如浅色主题、深色主题
）的系统中，通过 <code>ThemeResolver</code>
配合主题相关的视图解析、资源管理，能很好地实现不同主题的切换和呈现。</li>
</ul></li>
<li><p><code>FlashMapManager</code>：临时数据共享</p>
<ul>
<li><p>实现重定向时临时数据的共享功能。当控制器方法处理完请求，需要重定向到另一个
URL ，并且希望在重定向后能获取到一些 “一次性” 的数据（如提示信息
“操作成功，请查看详情” ）时，可通过 <code>FlashMap</code>
存储这些数据，<code>FlashMapManager</code> 负责管理
<code>FlashMap</code> 的创建、存储（通常存储在 Session 中
）和获取。重定向前将数据存入 <code>FlashMap</code>
，重定向后的请求处理时，<code>FlashMapManager</code>
会取出数据供后续使用，使用完后这些数据会被清除，保证是 “一次性” 的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/save&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">saveData</span><span class="params">(RedirectAttributes redirectAttributes)</span> &#123;</span><br><span class="line">    <span class="comment">// 业务处理...</span></span><br><span class="line">    redirectAttributes.addFlashAttribute(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;数据保存成功&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/list&quot;</span>;</span><br><span class="line">    <span class="comment">// 在重定向后的 /list 对应的控制器方法或视图中，就能获取到 msg 这个一次性提示数据。</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li><p><code>FormattingConversionService</code>：数据格式化、类型转化</p>
<ul>
<li>职责：承担着数据格式化和类型转换的重要职责。在请求参数绑定阶段，它会将
HTTP
请求中的字符串参数，按照一定规则转换为控制器方法入参的对应类型（比如把请求参数中的字符串
“2024-10-01” 转换为 <code>java.util.Date</code> 类型
）；在响应数据处理时，也能将一些复杂类型（如自定义的枚举类型
）格式化为合适的字符串或其他可传输的格式。同时，它默认集成了对 JSR303
校验相关的支持，在数据转换、绑定过程中，能配合校验注解（如
<code>@DateTimeFormat</code> 结合 <code>@Valid</code>
）进行数据格式的校验和转换。</li>
<li>扩展能力：用户可通过实现
<code>Formatter</code>、<code>Converter</code>
接口，自定义数据格式化和类型转换规则，然后注册到
<code>FormattingConversionService</code>
中，实现对特殊类型数据（如自定义的日期格式、自定义业务枚举
）的个性化转换和格式化。</li>
</ul></li>
<li><p><code>Validator</code>：数据校验 JSR303 提供的数据校验功能</p>
<ul>
<li>职责：提供数据校验功能，基于 JSR303（Java Bean Validation 规范
）及后续的 JSR349、JSR380 等规范，支持使用
<code>@Valid</code>、<code>@NotBlank</code>、<code>@Size</code>
等校验注解，对控制器方法的入参（如 <code>@RequestBody</code>
接收的对象、<code>@RequestParam</code> 绑定的参数等
）、实体类的属性进行校验。当校验不通过时，会抛出对应的校验异常，可结合
<code>ExceptionHandlerExceptionResolver</code>
进行统一的异常处理和错误提示返回，保证输入数据的合法性和规范性。</li>
</ul></li>
<li><p><code>WebBindingInitializer</code>：请求参数的封装与绑定</p>
<ul>
<li>在 Spring MVC
请求参数绑定的过程中，负责初始化数据绑定的相关设置。它会参与到请求参数转换为控制器方法入参的整个流程，比如设置默认的类型转换器（关联到
<code>FormattingConversionService</code>
）、初始化数据绑定的一些基础规则（如是否允许空值、日期格式的默认处理等
），确保请求参数能准确、合理地绑定到控制器方法的参数上，为控制器方法正确执行提供数据基础。</li>
<li>关联关系：与 <code>FormattingConversionService</code>
紧密协作，<code>FormattingConversionService</code>
提供具体的类型转换和格式化能力，<code>WebBindingInitializer</code>
则在绑定流程中运用这些能力，同时进行一些初始化、规则设置的工作。</li>
</ul></li>
<li><p><code>ContentNegotiationManager</code>：内容协商管理器</p>
<ul>
<li>职责：实现内容协商功能，决定客户端请求期望的响应数据格式，以及服务端实际返回的响应数据格式。它会综合考虑多个因素来确定响应格式，包括请求头中的
<code>Accept</code> 字段（客户端期望接收的媒体类型，如
<code>application/json</code>、<code>text/html</code> 等
）、请求参数（可通过设置参数如 <code>?format=json</code> 来指定响应格式
）等。根据协商结果，Spring MVC 会选择合适的消息转换器（如
<code>MappingJackson2HttpMessageConverter</code> 用于转换 JSON 格式
）来处理响应数据，保证返回给客户端的数据格式是其期望或可接受的。</li>
<li>应用场景：在一个同时提供 JSON 数据接口和 HTML 页面展示的 Web
应用中，通过 <code>ContentNegotiationManager</code>
，就能根据客户端不同的请求（如浏览器直接访问返回 HTML
页面，手机端接口调用返回 JSON 数据
），灵活返回对应的响应格式，提升应用的兼容性和适用性。</li>
</ul></li>
</ul></li>
<li><p><code>WebMvcAutoConfigurationAdapter</code>配置生效，它是一个<code>WebMvcConfigurer</code>，定义
mvc 底层组件</p>
<p><code>WebMvcAutoConfigurationAdapter</code> 是
<code>WebMvcAutoConfiguration</code> 内部的静态类，它实现了
<code>WebMvcConfigurer</code> 接口，作为 Spring Boot
自动配置的具体实现，用来定义 Spring MVC
底层组件的默认配置，以下是其关键配置点：</p>
<ul>
<li><p>定义好<code>WebMvcConfigurer</code>
底层组件默认功能；所有功能详见下面或者上面的列表</p></li>
<li><p>视图解析器：<code>InternalResourceViewResolver</code></p>
<ul>
<li>主要用于解析 JSP 等 “内部资源视图”。当控制器方法返回一个视图名（如
<code>return "userInfo"</code> ）时，它会按照配置的前缀（如
<code>prefix = "/WEB-INF/views/"</code> ）和后缀（如
<code>suffix = ".jsp"</code> ）规则，拼接出完整的视图资源路径（即
<code>/WEB-INF/views/userInfo.jsp</code> ），然后找到对应的 JSP
文件进行渲染，将动态数据填充到 JSP 页面中，最终返回给客户端呈现。在
<code>WebMvcAutoConfigurationAdapter</code> 中，会依据 Spring Boot
的默认配置策略，设置合适的前缀和后缀（也可通过
<code>application.properties</code> 等配置文件进行自定义调整
），适配常见的 JSP 视图存储目录结构，让基于 JSP 的 Web
应用能便捷地进行视图解析和渲染。</li>
</ul></li>
<li><p>视图解析器： <code>BeanNameViewResolver</code> ,
视图名（controller 方法的返回值字符串）就是组件名</p>
<ul>
<li>将控制器方法返回的视图名，直接作为 Spring 容器中 <code>View</code>
类型 Bean 的名称去查找对应的视图组件。也就是说，若控制器方法返回视图名
“customView” ，那么 Spring 容器中需要存在一个名为 “customView” 且类型为
<code>View</code> 的 Bean（可以是自定义的 <code>View</code> 实现类
），<code>BeanNameViewResolver</code> 会找到该 Bean
并使用它来渲染视图，实现灵活的视图定制。</li>
</ul></li>
<li><p>内容协商解析器： <code>ContentNegotiatingViewResolver</code></p>
<ul>
<li>它本身并不直接解析视图，而是结合
<code>ContentNegotiationManager</code>
的内容协商结果，从多个视图解析器（如
<code>InternalResourceViewResolver</code>、<code>BeanNameViewResolver</code>
等 ）中选择合适的视图解析器来解析视图。例如，内容协商确定需要返回 HTML
格式的视图，它就会在能解析 HTML 视图的解析器中挑选（如
<code>InternalResourceViewResolver</code> 若配置了解析 JSP 生成 HTML
），然后使用该解析器进行视图解析和渲染，是一个 “协调者”
角色，整合多种视图解析器和内容协商功能。</li>
<li>工作流程：先通过 <code>ContentNegotiationManager</code>
确定响应数据格式需求，再遍历其管理的视图解析器列表，找到第一个能满足该格式需求且能解析对应视图名的解析器，交由其进行视图解析和渲染，保证在内容协商的基础上，能正确找到并使用合适的视图资源。</li>
</ul></li>
<li><p>请求上下文过滤器：
<code>RequestContextFilter</code>：任意位置直接获取当前请求</p>
<ul>
<li>为应用中任意位置（包括非 Web 层的 Service、Component 等
）提供获取当前 HTTP
请求上下文（<code>HttpServletRequest</code>、<code>HttpServletResponse</code>
）的能力。它会在请求处理过程中，将当前的请求和响应对象绑定到线程局部变量（<code>ThreadLocal</code>
）中，后续在同一线程的任意位置，都可以通过
<code>RequestContextHolder.currentRequestAttributes()</code>
等方式获取到当前请求的上下文信息，方便一些非 Web
层组件在需要时使用请求相关的数据（如获取请求头信息、Session 数据等
）。</li>
<li>注意事项：因为是基于 <code>ThreadLocal</code>
实现，所以要注意线程安全和资源释放问题，在异步处理场景中，若不正确处理，可能会导致获取到错误的请求上下文或资源泄漏，不过
Spring Boot 对常见的异步场景也有相应的处理机制来保障其正确性。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">aService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getRequest</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ServletRequestAttributes</span> <span class="variable">attributes</span> <span class="operator">=</span> (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 任意位置通过  RequestContextHolder 获取到当前请求和响应的信息</span></span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> attributes.getRequest();</span><br><span class="line">        <span class="type">HttpServletResponse</span> <span class="variable">response</span> <span class="operator">=</span> attributes.getResponse();</span><br><span class="line">        </span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> request.getRequestURI(); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>静态资源链规则</p></li>
<li><p><code>ProblemDetailsExceptionHandler</code>：错误详情</p>
<ul>
<li>统一处理 Spring MVC
内部抛出的异常，生成标准化的错误详情响应。当控制器方法抛出异常（如参数校验失败的
<code>MethodArgumentNotValidException</code> 、资源未找到的
<code>NoSuchRequestHandlingMethodException</code> 等
）时，它会将异常信息封装成包含 <code>type</code>（错误类型标识
）、<code>title</code>（错误标题 ）、<code>status</code>（HTTP 状态码
）、<code>detail</code>（错误详情 ）等字段的 JSON
响应，让客户端能更清晰、规范地识别错误。</li>
</ul></li>
<li><p>定义了 MVC 默认的底层行为：<code>WebMvcConfigurer</code></p>
<ul>
<li><code>WebMvcAutoConfigurationAdapter</code> 本身就是
<code>WebMvcConfigurer</code> 的实现类，它为 Spring MVC
的<strong>所有底层行为</strong>提供了 “开箱即用” 的默认配置</li>
</ul></li>
</ul></li>
</ul></li>
</ol>
<h3 id="核心总结">核心总结</h3>
<p><code>WebMvcAutoConfiguration</code> 作为 Spring Boot
自动配置的核心，通过以下方式为 Web 应用搭建 MVC 基石：</p>
<ol type="1">
<li><strong>Filter 层</strong>：通过
<code>HiddenHttpMethodFilter</code>、<code>FormContentFilter</code>
补全浏览器请求能力，适配 RESTful 风格和非 POST 请求的表单处理。</li>
<li><strong>核心组件层</strong>：借助
<code>EnableWebMvcConfiguration</code> 初始化
<code>RequestMappingHandlerMapping</code>、<code>ExceptionHandlerExceptionResolver</code>
等 MVC 核心组件，构建 “请求路由 → 处理 → 异常处理” 的完整流程。</li>
<li><strong>默认配置层</strong>：通过
<code>WebMvcAutoConfigurationAdapter</code> 实现
<code>WebMvcConfigurer</code>
，为视图解析、资源处理、错误详情等提供开箱即用的默认规则，同时预留
<code>WebMvcConfigurer</code> 扩展点，支持用户按需覆盖。</li>
</ol>
<p>理解这些后，再看 Spring Boot 中的 Web 应用：<strong>大部分 MVC
需求（如静态资源、视图解析、异常处理 ）都能 “零配置”
运行</strong>，这背后正是 <code>WebMvcAutoConfiguration</code>
的功劳；而当需要定制（如修改 JSON 序列化规则、添加自定义拦截器
）时，只需实现 <code>WebMvcConfigurer</code> ，就能在默认配置基础上
“微创” 调整，既享受自动配置的便捷，又保留定制化的灵活性 。</p>
<p>使用表格总结如下</p>
<table>
<colgroup>
<col style="width: 17%">
<col style="width: 28%">
<col style="width: 28%">
<col style="width: 25%">
</colgroup>
<thead>
<tr>
<th>方法名</th>
<th>默认规则</th>
<th>核心参数</th>
<th>常用场景</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>configurePathMatch</code></td>
<td>默认启用后缀模式匹配（如<code>/users.html</code>匹配<code>/users</code>）和尾部斜杠匹配（如<code>/users/</code>匹配<code>/users</code>）</td>
<td>- <code>setUseSuffixPatternMatch</code>: 是否启用后缀模式匹配 -
<code>setUseTrailingSlashMatch</code>: 是否启用尾部斜杠匹配 -
<code>setPathMatcher</code>: 设置自定义路径匹配器</td>
<td>自定义 URL 匹配规则，如禁用<code>.html</code>后缀匹配</td>
</tr>
<tr>
<td><code>configureContentNegotiation</code></td>
<td>默认基于请求的 Accept 头确定响应内容类型，支持 JSON、XML 等</td>
<td>- <code>defaultContentType</code>: 设置默认内容类型 -
<code>favorPathExtension</code>: 是否优先使用 URL 扩展名进行内容协商 -
<code>mediaTypes</code>: 注册媒体类型映射</td>
<td>设置默认响应格式为 JSON，配置基于 URL 扩展名的内容协商</td>
</tr>
<tr>
<td><code>configureAsyncSupport</code></td>
<td>默认异步请求超时时间为 30 秒，使用 SimpleAsyncTaskExecutor
执行异步任务</td>
<td>- <code>setDefaultTimeout</code>: 设置异步请求超时时间 -
<code>setTaskExecutor</code>: 设置异步任务执行器 -
<code>registerCallableInterceptors</code>: 注册 Callable 拦截器</td>
<td>设置异步请求超时时间，配置 DeferredResult 处理</td>
</tr>
<tr>
<td><code>configureDefaultServletHandling</code></td>
<td>默认不启用默认 Servlet 处理，静态资源由 Spring MVC 处理</td>
<td>- <code>enable</code>: 启用默认 Servlet 处理 -
<code>enableDispatcherTypes</code>: 指定 DispatcherType</td>
<td>启用默认 Servlet 处理静态资源</td>
</tr>
<tr>
<td><code>addFormatters</code></td>
<td>默认注册 JSR-310 日期时间格式化器、数字格式化器等</td>
<td>- <code>FormatterRegistry</code>:
用于注册格式化器和转换器的注册表</td>
<td>添加日期格式化器，注册自定义类型转换器</td>
</tr>
<tr>
<td><code>addInterceptors</code></td>
<td>默认不注册任何拦截器</td>
<td>- <code>InterceptorRegistry</code>: 用于注册拦截器的注册表 -
<code>addPathPatterns</code>: 指定拦截路径 -
<code>excludePathPatterns</code>: 指定排除路径 - <code>order</code>:
设置拦截器顺序</td>
<td>添加身份验证拦截器，实现请求日志记录</td>
</tr>
<tr>
<td><code>addResourceHandlers</code></td>
<td>默认从<code>classpath:/META-INF/resources/</code>,
<code>classpath:/resources/</code>, <code>classpath:/static/</code>,
<code>classpath:/public/</code>加载静态资源，缓存控制头为 365 天</td>
<td>- <code>addResourceHandler</code>: 指定 URL 路径 -
<code>addResourceLocations</code>: 指定资源位置 -
<code>setCacheControl</code>: 设置缓存控制头 -
<code>setCachePeriod</code>: 设置缓存时间（秒）</td>
<td>配置静态资源路径，设置缓存控制头</td>
</tr>
<tr>
<td><code>addCorsMappings</code></td>
<td>默认不配置任何 CORS 映射</td>
<td>- <code>addMapping</code>: 指定 CORS 映射路径 -
<code>allowedOrigins</code>: 允许的源 - <code>allowedMethods</code>:
允许的 HTTP 方法 - <code>allowedHeaders</code>: 允许的请求头 -
<code>allowCredentials</code>: 是否允许发送 Cookie -
<code>maxAge</code>: 预检请求的有效期（秒）</td>
<td>允许特定域名访问 API，配置跨域请求头</td>
</tr>
<tr>
<td><code>addViewControllers</code></td>
<td>默认不注册任何视图控制器</td>
<td>- <code>ViewControllerRegistry</code>: 用于注册视图控制器的注册表 -
<code>addViewController</code>: 添加视图控制器 -
<code>setViewName</code>: 设置视图名称</td>
<td>简化登录页面、主页等简单视图的映射</td>
</tr>
<tr>
<td><code>configureViewResolvers</code></td>
<td>默认根据依赖自动配置视图解析器，如 Thymeleaf、FreeMarker 等</td>
<td>- <code>ViewResolverRegistry</code>: 用于配置视图解析器的注册表 -
<code>jsp</code>: 配置 JSP 视图解析器 - <code>thymeleaf</code>: 配置
Thymeleaf 视图解析器 - <code>freemarker</code>: 配置 FreeMarker
视图解析器</td>
<td>配置 JSP、Thymeleaf 等视图解析器</td>
</tr>
<tr>
<td><code>addArgumentResolvers</code></td>
<td>默认注册
RequestParamMethodArgumentResolver、PathVariableMethodArgumentResolver
等</td>
<td>- <code>HandlerMethodArgumentResolver</code>:
自定义参数解析器列表</td>
<td>添加自定义参数解析器，如用户会话参数</td>
</tr>
<tr>
<td><code>addReturnValueHandlers</code></td>
<td>默认注册
RequestResponseBodyMethodProcessor、ViewNameMethodReturnValueHandler
等</td>
<td>- <code>HandlerMethodReturnValueHandler</code>:
自定义返回值处理器列表</td>
<td>添加自定义返回值处理器，如统一 API 响应格式</td>
</tr>
<tr>
<td><code>configureMessageConverters</code></td>
<td>默认注册
MappingJackson2HttpMessageConverter、StringHttpMessageConverter 等</td>
<td>- <code>HttpMessageConverter</code>:
自定义消息转换器列表（将替换默认转换器）</td>
<td>完全自定义消息转换器，如使用自定义 JSON 序列化器</td>
</tr>
<tr>
<td><code>extendMessageConverters</code></td>
<td>默认注册
MappingJackson2HttpMessageConverter、StringHttpMessageConverter 等</td>
<td>- <code>HttpMessageConverter</code>:
自定义消息转换器列表（添加到默认转换器之后）</td>
<td>在默认转换器基础上添加自定义转换器</td>
</tr>
<tr>
<td><code>configureHandlerExceptionResolvers</code></td>
<td>默认注册
ExceptionHandlerExceptionResolver、ResponseStatusExceptionResolver
等</td>
<td>- <code>HandlerExceptionResolver</code>:
自定义异常解析器列表（将替换默认解析器）</td>
<td>完全自定义异常处理机制</td>
</tr>
<tr>
<td><code>extendHandlerExceptionResolvers</code></td>
<td>默认注册
ExceptionHandlerExceptionResolver、ResponseStatusExceptionResolver
等</td>
<td>- <code>HandlerExceptionResolver</code>:
自定义异常解析器列表（添加到默认解析器之后）</td>
<td>添加自定义异常处理器</td>
</tr>
<tr>
<td><code>addErrorResponseInterceptors</code></td>
<td>默认不注册任何错误响应拦截器</td>
<td>- <code>ErrorResponse.Interceptor</code>: 错误响应拦截器列表</td>
<td>自定义错误响应格式，添加额外错误信息</td>
</tr>
<tr>
<td><code>getValidator</code></td>
<td>默认使用 Spring 的 LocalValidatorFactoryBean，支持 JSR-303/349
验证</td>
<td>- 返回实现 Validator 接口的自定义验证器</td>
<td>提供自定义验证器，如使用 Hibernate Validator</td>
</tr>
<tr>
<td><code>getMessageCodesResolver</code></td>
<td>默认使用 DefaultMessageCodesResolver</td>
<td>- 返回实现 MessageCodesResolver 接口的自定义解析器</td>
<td>自定义错误代码解析逻辑</td>
</tr>
</tbody>
</table>
<h2 id="enablewebmvc-禁用默行为的原理"><span class="citation" data-cites="EnableWebMvc">@EnableWebMvc</span> 禁用默行为的原理</h2>
<h3 id="enablewebmvc-的作用"><code>@EnableWebMvc</code> 的作用</h3>
<ul>
<li><p>核心逻辑：</p>
<p><code>@EnableWebMvc</code> 会向 Spring 容器中导入
<code>DelegatingWebMvcConfiguration</code>组件。</p>
<ul>
<li>而 <code>DelegatingWebMvcConfiguration</code> 是
<code>WebMvcConfigurationSupport</code> 的子类 ，这意味着一旦使用
<code>@EnableWebMvc</code>，本质上就是让
<code>WebMvcConfigurationSupport</code> 相关逻辑进入容器。</li>
</ul></li>
</ul>
<h3 id="spring-boot-中-spring-mvc-自动配置的条件">Spring Boot 中 Spring
MVC 自动配置的条件</h3>
<ul>
<li><p><strong>关键注解</strong>：<code>WebMvcAutoConfiguration</code>（Spring
Boot 对 Spring MVC 的自动配置类）上有一个条件注解：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConditionalOnMissingBean(WebMvcConfigurationSupport.class)</span></span><br></pre></td></tr></table></figure>
<p>含义是：<strong>当 Spring 容器中没有
<code>WebMvcConfigurationSupport</code> 类型的 Bean
时</strong>，<code>WebMvcAutoConfiguration</code> 才会生效，进而启用
Spring Boot 对 Spring MVC 的默认自动配置。</p></li>
</ul>
<h3 id="enablewebmvc-禁用默认自动配置的原因"><code>@EnableWebMvc</code>
禁用默认自动配置的原因</h3>
<ul>
<li>因为 <code>@EnableWebMvc</code> 导入了
<code>WebMvcConfigurationSupport</code>（通过
<code>DelegatingWebMvcConfiguration</code> 间接引入 ），此时容器中存在
<code>WebMvcConfigurationSupport</code> 类型的 Bean。</li>
<li>这就触发了 <code>WebMvcAutoConfiguration</code> 的条件注解
<code>@ConditionalOnMissingBean(WebMvcConfigurationSupport.class)</code>
<strong>不满足条件</strong>，导致 <code>WebMvcAutoConfiguration</code>
失效，最终禁用了 Spring Boot 对 Spring MVC 的默认自动配置行为。</li>
</ul>
<p>所以，<strong><code>@EnableWebMvc</code>
的影响</strong>体现在，一旦在配置类上标注
<code>@EnableWebMvc</code>，会让 Spring Boot 中 Spring MVC
的自动配置失效，需要你自己通过 <code>WebMvcConfigurer</code>（或直接继承
<code>WebMvcConfigurationSupport</code>）手动配置 Spring MVC
的底层组件（如拦截器、消息转换器、视图解析器等 。</p>
<p>而<code>WebMvcConfigurer</code> 的角色就充当是一个定义 Spring MVC
底层组件功能的接口，你可以实现它来定制 Spring MVC 行为。<strong>即使不用
<code>@EnableWebMvc</code>（即保留 Spring Boot 自动配置），也能通过
<code>WebMvcConfigurer</code> 做定制化扩展</strong>；但用了
<code>@EnableWebMvc</code> 后，自动配置失效，更需要实现
<code>WebMvcConfigurer</code> 接口或更底层的
<code>WebMvcConfigurationSupport</code> 接口来手动搭建 MVC
功能，实现自己的 <code>WebMvcConfigurer</code>配置类。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://github.com/ergou10086">ErgouTree</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://ergou10086.github.io/posts/8200.html">https://ergou10086.github.io/posts/8200.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://ergou10086.github.io" target="_blank">ErgouTree's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java%E6%8A%80%E6%9C%AF/">Java技术</a><a class="post-meta__tags" href="/tags/JavaWeb/">JavaWeb</a><a class="post-meta__tags" href="/tags/%E6%A1%86%E6%9E%B6%E7%9F%A5%E8%AF%86/">框架知识</a><a class="post-meta__tags" href="/tags/%E5%AD%A6%E4%B9%A0/">学习</a><a class="post-meta__tags" href="/tags/JavaEE/">JavaEE</a><a class="post-meta__tags" href="/tags/Web/">Web</a><a class="post-meta__tags" href="/tags/Spring%E7%B3%BB%E5%88%97/">Spring系列</a><a class="post-meta__tags" href="/tags/Servlet/">Servlet</a><a class="post-meta__tags" href="/tags/Spring-Boot/">Spring Boot</a><a class="post-meta__tags" href="/tags/Java%E6%A1%86%E6%9E%B6/">Java框架</a><a class="post-meta__tags" href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">源码分析</a><a class="post-meta__tags" href="/tags/%E9%85%8D%E7%BD%AE%E7%9B%B8%E5%85%B3/">配置相关</a></div><div class="post-share"><div class="addtoany"><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_wechat"></a><a class="a2a_button_sina_weibo"></a><a class="a2a_button_facebook_messenger"></a><a class="a2a_button_email"></a><a class="a2a_button_copy_link"></a><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a></div></div><script async="async" src="https://static.addtoany.com/menu/page.js"></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/posts/6874.html" title="Spring Boot part12-嵌入式容器"><img class="cover" src="/images/posts/cover_main.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Spring Boot part12-嵌入式容器</div></div><div class="info-2"><div class="info-item-1">前言 Spring Boot 的目标是构建“非常容易创建、独立、产品级别的基于Spring的应用”。这些应用是“立即可运行的”。在这个过程中，完全没有代码生成，不需要配置任何特殊的XML配置，为了这个目标，Spring Boot 在 Spring 4.0 框架之上提供了很多特性，帮助应用以“约定优于配置”“开箱即用”的方式来启动应用并运行上下文。 Spring Boot 同样改变了一个传统的 Web 应用服务的启动流程和部署方式。通过自动配置机制，Spring Boot 提供了一个嵌入式的运行时容器环境，并使用代码注解的方式在代码中将 URL 服务地址映射到 Controller 的方法完成服务映射。 所以，开发者不再需要关心传统容器（如 Tomcat）中web.xml的配置，同时实现容器的具体技术都是可替换及可更改的，这些技术以插件化的Starter组件方式在运行时加载到 Spring...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/6874.html" title="Spring Boot part12-嵌入式容器"><img class="cover" src="/images/posts/cover_main.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-11</div><div class="info-item-2">Spring Boot part12-嵌入式容器</div></div><div class="info-2"><div class="info-item-1">前言 Spring Boot 的目标是构建“非常容易创建、独立、产品级别的基于Spring的应用”。这些应用是“立即可运行的”。在这个过程中，完全没有代码生成，不需要配置任何特殊的XML配置，为了这个目标，Spring Boot 在 Spring 4.0 框架之上提供了很多特性，帮助应用以“约定优于配置”“开箱即用”的方式来启动应用并运行上下文。 Spring Boot 同样改变了一个传统的 Web 应用服务的启动流程和部署方式。通过自动配置机制，Spring Boot 提供了一个嵌入式的运行时容器环境，并使用代码注解的方式在代码中将 URL 服务地址映射到 Controller 的方法完成服务映射。 所以，开发者不再需要关心传统容器（如 Tomcat）中web.xml的配置，同时实现容器的具体技术都是可替换及可更改的，这些技术以插件化的Starter组件方式在运行时加载到 Spring...</div></div></div></a><a class="pagination-related" href="/posts/undefined.html" title="Spring Framework part2--IoC容器之IoC原理"><img class="cover" src="/images/posts/cover_java3.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-19</div><div class="info-item-2">Spring Framework part2--IoC容器之IoC原理</div></div><div class="info-2"><div class="info-item-1">Spring...</div></div></div></a><a class="pagination-related" href="/posts/60585.html" title="Spring Boot part9-路径匹配与内容协商"><img class="cover" src="/images/posts/cover_front.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-08</div><div class="info-item-2">Spring Boot part9-路径匹配与内容协商</div></div><div class="info-2"><div class="info-item-1">路径匹配 路径匹配概述 在 Spring 框架（这里聚焦于 Spring5.3 及后续版本涉及的请求路径匹配相关内容 ）里，请求路径匹配是很关键的部分，是处理 Web 请求时确定 URL 路径与控制器方法映射关系的核心机制。 路径匹配是指框架如何将传入的 HTTP 请求 URL 映射到对应的控制器方法上。例如，当用户访问 /users/123 时，框架需要决定这个请求应该由哪个 @GetMapping 或 @RequestMapping 注解的方法来处理。 在 Spring Framework 5.3 及 Spring Boot 2.4 之后，引入了一种新的路径匹配机制，这一变化在 Spring Boot 3 中得到了保留和进一步的应用。这个新机制主要是通过 PathPattern 代替了传统的 AntPathMatcher。 AntPathMatcher 是基于 Ant 风格的路径匹配，而 PathPattern 则是一个更高效、更精确的路径匹配方式，它是通过...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/arp.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">ErgouTree</div><div class="author-info-description">I start a brand-new life with you.</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">121</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">80</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">51</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ergou10086"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/ergou10086" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="/zjm88822201@126.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://space.bilibili.com/142045656?spm_id_from=333.1007.0.0" target="_blank" title="bilibili"><i class="fas fa-brands fa-bilibili" style="color: #4a72be;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">作者长期陷入galgame和osu!maina4k中 祝他好运吧 对了 如果图片加载过慢 建议科学上网进行使用</div></div><div class="card-widget"><div class="item-headline"><i></i><span></span></div><div class="item-content"></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E9%9D%A2%E6%8E%A5%E7%AE%A1-springmvc-%E7%9A%84%E6%80%9D%E8%B7%AF"><span class="toc-number">1.</span> <span class="toc-text">全面接管 SpringMVC 的思路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#webmvcconfigurer-%E6%8E%A5%E5%8F%A3%E5%88%86%E6%9E%90%E5%8F%8A%E6%96%B9%E6%B3%95%E8%AF%A6%E8%A7%A3"><span class="toc-number">2.</span> <span class="toc-text">WebMvcConfigurer
接口分析及方法详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90"><span class="toc-number">2.1.</span> <span class="toc-text">源码分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#configuremessageconverters-vs-extendmessageconverters"><span class="toc-number">2.2.</span> <span class="toc-text">configureMessageConverters
vs extendMessageConverters</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#addinterceptorsinterceptorregistry-registry"><span class="toc-number">2.3.</span> <span class="toc-text">addInterceptors(InterceptorRegistry registry)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#addresourcehandlers"><span class="toc-number">2.4.</span> <span class="toc-text">addResourceHandlers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#addcorsmappings"><span class="toc-number">2.5.</span> <span class="toc-text">addCorsMappings</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#configurehandlerexceptionresolvers-vs-extendhandlerexceptionresolvers"><span class="toc-number">2.6.</span> <span class="toc-text">configureHandlerExceptionResolvers
vs extendHandlerExceptionResolvers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#configurecontentnegotiationcontentnegotiationconfigurer-configurer"><span class="toc-number">2.7.</span> <span class="toc-text">configureContentNegotiation(ContentNegotiationConfigurer configurer)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#configureasyncsupportasyncsupportconfigurer-configurer"><span class="toc-number">2.8.</span> <span class="toc-text">configureAsyncSupport(AsyncSupportConfigurer configurer)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#configurepathmatchpathmatchconfigurer-configurer"><span class="toc-number">2.9.</span> <span class="toc-text">configurePathMatch(PathMatchConfigurer configurer)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#webmvcautoconfiguration-%E5%88%B0%E5%BA%95%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E4%BA%86%E5%93%AA%E4%BA%9B%E8%A7%84%E5%88%99"><span class="toc-number">3.</span> <span class="toc-text">WebMvcAutoConfiguration
到底自动配置了哪些规则</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%80%BB%E7%BB%93"><span class="toc-number">3.1.</span> <span class="toc-text">核心总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#enablewebmvc-%E7%A6%81%E7%94%A8%E9%BB%98%E8%A1%8C%E4%B8%BA%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-number">4.</span> <span class="toc-text">@EnableWebMvc 禁用默行为的原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#enablewebmvc-%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">4.1.</span> <span class="toc-text">@EnableWebMvc 的作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#spring-boot-%E4%B8%AD-spring-mvc-%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E7%9A%84%E6%9D%A1%E4%BB%B6"><span class="toc-number">4.2.</span> <span class="toc-text">Spring Boot 中 Spring
MVC 自动配置的条件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#enablewebmvc-%E7%A6%81%E7%94%A8%E9%BB%98%E8%AE%A4%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E7%9A%84%E5%8E%9F%E5%9B%A0"><span class="toc-number">4.3.</span> <span class="toc-text">@EnableWebMvc
禁用默认自动配置的原因</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/8200.html" title="Spring Boot part13-全面接管Spring MVC"><img src="/images/posts/cover_java15.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spring Boot part13-全面接管Spring MVC"/></a><div class="content"><a class="title" href="/posts/8200.html" title="Spring Boot part13-全面接管Spring MVC">Spring Boot part13-全面接管Spring MVC</a><time datetime="2025-06-11T09:01:51.000Z" title="发表于 2025-06-11 17:01:51">2025-06-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/6874.html" title="Spring Boot part12-嵌入式容器"><img src="/images/posts/cover_main.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spring Boot part12-嵌入式容器"/></a><div class="content"><a class="title" href="/posts/6874.html" title="Spring Boot part12-嵌入式容器">Spring Boot part12-嵌入式容器</a><time datetime="2025-06-11T08:58:40.000Z" title="发表于 2025-06-11 16:58:40">2025-06-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/53520.html" title="Butterfly主题常见的标签外挂"><img src="/images/posts/cover_6x.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Butterfly主题常见的标签外挂"/></a><div class="content"><a class="title" href="/posts/53520.html" title="Butterfly主题常见的标签外挂">Butterfly主题常见的标签外挂</a><time datetime="2025-06-11T07:14:57.000Z" title="发表于 2025-06-11 15:14:57">2025-06-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/23249.html" title="为typora更换更新版本的mermaid避免图表无法加载"><img src="/images/posts/cover_java6.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="为typora更换更新版本的mermaid避免图表无法加载"/></a><div class="content"><a class="title" href="/posts/23249.html" title="为typora更换更新版本的mermaid避免图表无法加载">为typora更换更新版本的mermaid避免图表无法加载</a><time datetime="2025-06-08T10:03:02.000Z" title="发表于 2025-06-08 18:03:02">2025-06-08</time></div></div></div></div></div></div></main><div class="fps-display"><span id="fps">FPS: 60</span></div><footer id="footer" style="background-image: url(/images/posts/cover_java15.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By ErgouTree</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div><div class="footer_custom_text">忘れたくない思い、ありますか？ <br>,<span id="realtime_duration" style="font-family: monospace;"></span>,<br><a href="https://icp.gov.moe/?keyword=20257009" target="_blank">萌ICP备20257009号</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><a class="icon-V hidden" onclick="switchNightMode()" title="日间和夜间模式切换"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat-btn" type="button" title="聊天" style="display:none"><i class="fas fa-comment"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const applyThemeDefaultsConfig = theme => {
    if (theme === 'dark-mode') {
      Chart.defaults.color = "rgba(255, 255, 255, 0.8)"
      Chart.defaults.borderColor = "rgba(255, 255, 255, 0.2)"
      Chart.defaults.scale.ticks.backdropColor = "transparent"
    } else {
      Chart.defaults.color = "rgba(0, 0, 0, 0.8)"
      Chart.defaults.borderColor = "rgba(0, 0, 0, 0.1)"
      Chart.defaults.scale.ticks.backdropColor = "transparent"
    }
  }

  // Recursively traverse the config object and automatically apply theme-specific color schemes
  const applyThemeConfig = (obj, theme) => {
    if (typeof obj !== 'object' || obj === null) return

    Object.keys(obj).forEach(key => {
      const value = obj[key]
      // If the property is an object and has theme-specific options, apply them
      if (typeof value === 'object' && value !== null) {
        if (value[theme]) {
          obj[key] = value[theme] // Apply the value for the current theme
        } else {
          // Recursively process child objects
          applyThemeConfig(value, theme)
        }
      }
    })
  }

  const runChartJS = ele => {
    window.loadChartJS = true

    Array.from(ele).forEach((item, index) => {
      const chartSrc = item.firstElementChild
      const chartID = item.getAttribute('data-chartjs-id') || ('chartjs-' + index) // Use custom ID or default ID
      const width = item.getAttribute('data-width')
      const existingCanvas = document.getElementById(chartID)

      // If a canvas already exists, remove it to avoid rendering duplicates
      if (existingCanvas) {
          existingCanvas.parentNode.remove()
      }

      const chartDefinition = chartSrc.textContent
      const canvas = document.createElement('canvas')
      canvas.id = chartID

      const div = document.createElement('div')
      div.className = 'chartjs-wrap'

      if (width) {
        div.style.width = width
      }

      div.appendChild(canvas)
      chartSrc.insertAdjacentElement('afterend', div)

      const ctx = document.getElementById(chartID).getContext('2d')

      const config = JSON.parse(chartDefinition)

      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark-mode' : 'light-mode'

      // Set default styles (initial setup)
      applyThemeDefaultsConfig(theme)

      // Automatically traverse the config and apply dual-mode color schemes
      applyThemeConfig(config, theme)

      new Chart(ctx, config)
    })
  }

  const loadChartJS = () => {
    const chartJSEle = document.querySelectorAll('#article-container .chartjs-container')
    if (chartJSEle.length === 0) return

    window.loadChartJS ? runChartJS(chartJSEle) : btf.getScript('https://cdn.jsdelivr.net/npm/chart.js/dist/chart.umd.min.js').then(() => runChartJS(chartJSEle))
  }

  // Listen for theme change events
  btf.addGlobalFn('themeChange', loadChartJS, 'chartjs')
  btf.addGlobalFn('encrypt', loadChartJS, 'chartjs')

  window.pjax ? loadChartJS() : document.addEventListener('DOMContentLoaded', loadChartJS)
})()</script><script>(function() {
  const abcjsInit = function() {
    const abcjsFn = function() {
      setTimeout(function() {
        const sheets = document.querySelectorAll(".abc-music-sheet")
        for (let i = 0; i < sheets.length; i++) {
          const ele = sheets[i]
          if (ele.children.length > 0) continue

          // Parse parameters from data-params attribute
          let params = {}
          const dp = ele.getAttribute("data-params")
          if (dp) {
            try {
              params = JSON.parse(dp)
            } catch (e) {
              console.error("Failed to parse data-params:", e)
            }
          }

          // Merge parsed parameters with the responsive option
          // Ensures params content appears before responsive
          const options = { ...params, responsive: "resize" }

          // Render the music score using ABCJS.renderAbc
          ABCJS.renderAbc(ele, ele.innerHTML, options)
        }
      }, 100)
    }

    if (typeof ABCJS === "object") {
      abcjsFn()
    } else {
      btf.getScript("https://cdn.jsdelivr.net/npm/abcjs/dist/abcjs-basic-min.min.js").then(abcjsFn)
    }
  }

  if (window.pjax) {
    abcjsInit()
  } else {
    window.addEventListener("load", abcjsInit)
  }

  btf.addGlobalFn("encrypt", abcjsInit, "abcjs")
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = {"labels":["Gitalk","Comment"],"createIssueManually":false,"distractionFreeMode":false}

  const commentCount = n => {
    const isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
    if (isCommentCount) {
      isCommentCount.textContent= n
    }
  }

  const initGitalk = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyGitalk = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const gitalk = new Gitalk({
      clientID: 'Ov23li3vDQANiUddL4XB',
      clientSecret: '5c9a56d02995340fca117809cd414662aadce6ff',
      repo: 'HexoComment',
      owner: 'ergou10086',
      admin: ['ergou10086'],
      updateCountCallback: commentCount,
      ...option,
      id: isShuoshuo ? path : (option && option.id) || '9a32dc8c02eb54540c2cacb7db6f658d'
    })

    gitalk.render('gitalk-container')
  }

  const loadGitalk = async(el, path) => {
    if (typeof Gitalk === 'function') initGitalk(el, path)
    else {
      await btf.getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
      await btf.getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js')
      initGitalk(el, path)
    }
  }

  if (isShuoshuo) {
    'Gitalk' === 'Gitalk'
      ? window.shuoshuoComment = { loadComment: loadGitalk }
      : window.loadOtherComment = loadGitalk
    return
  }

  if ('Gitalk' === 'Gitalk' || !false) {
    if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
    else loadGitalk()
  } else {
    window.loadOtherComment = loadGitalk
  }
})()</script></div><div class="aplayer no-destroy" data-id="13587761608" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="false" data-lrcType="-1"> </div><script src="https://cdn.jsdelivr.net/npm/abcjs@7.1.2/dist/abcjs-basic-min.js"></script><script src="/js/sun_moon.js" async></script><script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.7/dayjs.min.js"></script><script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.7/plugin/duration.min.js"></script><script src="/scripts/realtime.js"></script><script src="/scripts/random.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="null" data-click="true"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script>(() => {
  window.ChatraID = '4bzb546NSBoJcrNyu'
  window.Chatra = window.Chatra || function() {
    (window.Chatra.q = window.Chatra.q || []).push(arguments)
  }

  btf.getScript('https://call.chatra.io/chatra.js').then(() => {
    const isChatBtn = true
    const isChatHideShow = true

    if (isChatBtn) {
      const close = () => {
        Chatra('minimizeWidget')
        Chatra('hide')
      }

      const open = () => {
        Chatra('openChat', true)
        Chatra('show')
      }

      window.ChatraSetup = { startHidden: true }
    
      window.chatBtnFn = () => document.getElementById('chatra').classList.contains('chatra--expanded') ? close() : open()

      document.getElementById('chat-btn').style.display = 'block'
    } else if (isChatHideShow) {
      window.chatBtn = {
        hide: () => Chatra('hide'),
        show: () => Chatra('show')
      }
    }
  })
})()</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"]):not([href="/music/"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      const usePjax = true
      true 
        ? (usePjax ? pjax.loadUrl('/404.html') : window.location.href = '/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})()</script><script src="/js/fps-display.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/7844.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="/images/posts/cover_database.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-05-14</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/7844.html&quot;);" href="javascript:void(0);" alt="">结构化查询语言SQL</a><div class="blog-slider__text">SQL基本很常用的语句都在这里了，本质上是当初为了应付数据库考试整理的，后来发现还蛮有用的很方便查常用的语句</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/7844.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/39918.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="/images/posts/cover_java4.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-05-22</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/39918.html&quot;);" href="javascript:void(0);" alt="">SpringBoot part0?INF-SpringBoot这个框架都需要学习什么</a><div class="blog-slider__text">主要围绕Spring Boot中重要知识来简洁或详细的说明，其中部分不够完全，持续更新</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/39918.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/42179.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="/images/posts/cover_java11.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-05-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/42179.html&quot;);" href="javascript:void(0);" alt="">关于Lombok在高版本IDEA中注解处理不生效的问题解决</a><div class="blog-slider__text">基本上是彻底的解决了用 IDEA 新建 Spring Boot 项目时候会产生的 Lombok 注解处理失效的各种问题</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/42179.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/40344.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="/images/posts/cover_实用.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-05-05</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/40344.html&quot;);" href="javascript:void(0);" alt="">个人向galgame原声带或相关音乐整理及其资源</a><div class="blog-slider__text">整理了我喜欢的galgame ost或者衍生的音乐专辑，部分资源是自己扒盘扒下来的，部分来自鸟白岛放映厅</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/40344.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/6458.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="/images/posts/cover_math.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-05-17</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/6458.html&quot;);" href="javascript:void(0);" alt="">对书上证明样本方差是总体方差的无偏估计量的解析</a><div class="blog-slider__text">对书上证明样本方差是总体方差的无偏估计量的解析，高等教育出版社-华科大版本</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/6458.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/12811.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="/images/posts/cover_alog.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-04-24</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/12811.html&quot;);" href="javascript:void(0);" alt="">第十五届蓝桥杯Java国赛B组D题-园丁题解</a><div class="blog-slider__text">第十五届蓝桥杯Java国赛B组D题-园丁题解，该题解已经发布到洛谷社区中并且被全站推荐</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/12811.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/27893.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="/images/posts/cover_java4.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-04-29</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/27893.html&quot;);" href="javascript:void(0);" alt="">操作系统之处理机的死锁部分概述</a><div class="blog-slider__text">对操作系统之处理机的死锁部分知识的总结，包括代码复现</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/27893.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/28134.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="/images/posts/cover_lb.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-05-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/28134.html&quot;);" href="javascript:void(0);" alt="">Little Busters!EX游戏攻略</a><div class="blog-slider__text">整理了一份详细清晰的Little Busters！EX的游戏攻略，因为我自己也在推，就顺手整理了一份方便查阅的md文档</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/28134.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/9323.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="/images/posts/cover_java9.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-05-16</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/9323.html&quot;);" href="javascript:void(0);" alt="">Spring Boot中使用Hibernate框架</a><div class="blog-slider__text">对学习完Hibernate的应用部分，主要围绕Spring Boot中使用Hibernate框架，建议学习完 Hibernate 框架再看</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/9323.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><!-- hexo injector body_end end --></body></html>